version: v1
description: This workflow provisions a new GKE cluster and deploys a demo app in it
steps:
- name: terraform-provision-gke
  image: projectnebula/terraform:latest
  spec:
    vars:
      gcp_region: europe-west3
      gcp_location: europe-west3-a
      gcp_project:
        $type: Secret
        name: gcp-project
    directory: terraform/gke/
    credentials:
      credentials.json:
        $type: Secret
        name: gcp-credentials
    git:
      name: nebula-workflows
      repository: https://github.com/kreeuwijk/nebula-workflows.git
      ssh_key: ''
      known_hosts: ''